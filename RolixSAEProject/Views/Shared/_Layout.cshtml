@using Microsoft.Extensions.Localization
@inject IStringLocalizer<RolixSAEProject.SharedResource> L

<!DOCTYPE html>
<html lang="@System.Globalization.CultureInfo.CurrentUICulture.TwoLetterISOLanguageName">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - RolixSAEProject</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/RolixSAEProject.styles.css" asp-append-version="true" />
    @RenderSection("Styles", required: false)

</head>
<body>
    @{
        var currentCurrency = Context.Request.Cookies["Currency"] ?? "EUR";
        var returnUrl = Context.Request.Path + Context.Request.QueryString;
        var currency = (ViewData["Currency"] as string) ?? "EUR";

        var currentLang = System.Globalization.CultureInfo.CurrentUICulture.TwoLetterISOLanguageName; // "fr" ou "en"
    }

    <header class="app-header">
        <div class="header-shell">
            <a class="brand" asp-controller="Home" asp-action="Index">ROLIX</a>

            <nav class="header-nav">
                <a class="nav-link @(ViewContext.RouteData.Values["controller"]?.ToString() == "Home" ? "active" : string.Empty)"
                   asp-controller="Home" asp-action="Index">@L["Nav_Home"]</a>

                <a class="nav-link @(ViewContext.RouteData.Values["controller"]?.ToString() == "Produits" ? "active" : string.Empty)"
                   asp-controller="Produits" asp-action="Index">@L["Nav_Products"]</a>

                <a class="nav-link @(ViewContext.RouteData.Values["action"]?.ToString() == "AboutUs" ? "active" : string.Empty)"
                   asp-controller="Home" asp-action="AboutUs">@L["Nav_About"]</a>
            </nav>

            <div class="header-actions">
                <div class="language-switch">
                    <a class="language @(currentLang == "fr" ? "active" : "")"
                       asp-controller="Preferences"
                       asp-action="SetLanguage"
                       asp-route-culture="fr"
                       asp-route-returnUrl="@returnUrl">FR</a>

                    <span class="divider">/</span>

                    <a class="language @(currentLang == "en" ? "active" : "")"
                       asp-controller="Preferences"
                       asp-action="SetLanguage"
                       asp-route-culture="en"
                       asp-route-returnUrl="@returnUrl">EN</a>
                </div>

                <div class="currency-switch" data-dropdown="currency">
                    <button type="button"
                            class="currency-button"
                            aria-haspopup="true"
                            aria-expanded="false"
                            aria-controls="currency-menu">
                        <span class="currency-code">@currentCurrency</span>
                        <span class="chevron" aria-hidden="true">▾</span>
                    </button>

                    <div id="currency-menu" class="currency-menu" role="menu" aria-label="@L["Currency_AriaLabel"]">
                        <a role="menuitem"
                           class="currency-item @(currentCurrency == "EUR" ? "is-active" : "")"
                           asp-controller="Preferences"
                           asp-action="SetCurrency"
                           asp-route-currency="EUR"
                           asp-route-returnUrl="@returnUrl"
                           aria-disabled="@(currentCurrency == "EUR" ? "true" : "false")"
                           tabindex="@(currentCurrency == "EUR" ? "-1" : "0")">
                            EUR <span class="currency-hint">€</span>
                        </a>

                        <a role="menuitem"
                           class="currency-item @(currentCurrency == "CHF" ? "is-active" : "")"
                           asp-controller="Preferences"
                           asp-action="SetCurrency"
                           asp-route-currency="CHF"
                           asp-route-returnUrl="@returnUrl"
                           aria-disabled="@(currentCurrency == "CHF" ? "true" : "false")"
                           tabindex="@(currentCurrency == "CHF" ? "-1" : "0")">
                            CHF <span class="currency-hint">CHF</span>
                        </a>

                        <a role="menuitem"
                           class="currency-item @(currentCurrency == "USD" ? "is-active" : "")"
                           asp-controller="Preferences"
                           asp-action="SetCurrency"
                           asp-route-currency="USD"
                           asp-route-returnUrl="@returnUrl"
                           aria-disabled="@(currentCurrency == "USD" ? "true" : "false")"
                           tabindex="@(currentCurrency == "USD" ? "-1" : "0")">
                            USD <span class="currency-hint">$</span>
                        </a>
                    </div>
                </div>

                <a class="account-link" href="#">@L["MyAccount"]</a>
            </div>
        </div>
    </header>

    <main role="main" class="page-wrapper">
        @RenderBody()
    </main>

    <footer class="app-footer">
        <div class="footer-shell">
            <div class="brand">ROLIX</div>
            <div class="footer-links">
                <a href="#">@L["Footer_Privacy"]</a>
                <a href="#">@L["Footer_Terms"]</a>
                <a href="#">@L["Footer_Contact"]</a>
            </div>
            <p class="footer-copy">@L["Footer_Copy"]</p>
        </div>
    </footer>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
