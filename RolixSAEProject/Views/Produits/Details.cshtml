@model RolixSAEProject.Models.Produit

@section Styles {
    <link rel="stylesheet" href="~/css/products.css" asp-append-version="true" />
}

@{
    ViewData["Title"] = "Détail du produit";

    var currency = ViewBag.CurrentCurrency as string ?? "EUR";
    var symbol = currency switch
    {
        "CHF" => "CHF",
        "USD" => "$",
        _ => "€"
    };

    var imageUrl = !string.IsNullOrWhiteSpace(Model.ImageUrl)
        ? Model.ImageUrl
        : Url.Content("~/images/placeholder-watch.svg");

    // Helpers d'affichage (évite les champs vides)
    var mouvement = string.IsNullOrWhiteSpace(Model.Mouvement) ? "—" : Model.Mouvement;
    var calibre = string.IsNullOrWhiteSpace(Model.Calibre) ? "—" : Model.Calibre;
    var materiau = string.IsNullOrWhiteSpace(Model.Materiau) ? "—" : Model.Materiau;
    var bracelet = string.IsNullOrWhiteSpace(Model.Bracelet) ? "—" : Model.Bracelet;
    var verre = string.IsNullOrWhiteSpace(Model.Verre) ? "—" : Model.Verre;

    // Selon ton type côté model (int? / int), adapte si besoin
    var tailleBoitier = (Model.TailleBoitierMm > 0) ? $"{Model.TailleBoitierMm}mm" : "—";

    // Étanchéité est "texte une ligne" dans Dataverse => souvent string ("200")
    var etancheite = string.IsNullOrWhiteSpace(Model.EtancheiteM) ? "—" : $"{Model.EtancheiteM}m";

    var loupeCyclope = Model.LoupeCyclope ? "Oui" : "Non";

    // Pour "Saphir (loupe Cyclope)" dans la section détaillée
    var verreDetail = verre;
    if (Model.LoupeCyclope && verreDetail != "—")
    {
        verreDetail = $"{verreDetail} (loupe Cyclope)";
    }
}

<div class="details-shell">

    <div class="details-breadcrumb">
        <a asp-controller="Produits" asp-action="Index">Produits</a>
        <span> / </span>
        <span>@Model.Nom</span>
    </div>

    <div class="details-grid">

        <div class="details-media">
            <img src="@imageUrl" alt="@Model.Nom" />
        </div>

        <div class="details-card">
            <h1 class="details-title">@Model.Nom</h1>

            <p class="details-ref">
                Collection : @Model.Collection
            </p>

            <div class="details-price">
                @Model.GetPrice(currency).ToString("N0") @symbol
            </div>

            <div class="details-divider"></div>

            <h2 class="details-section-title">Description</h2>
            <p class="details-text">
                @Model.DescriptionFR
            </p>

            <div class="details-divider"></div>

            <h2 class="details-section-title">Caractéristique principale</h2>

            <div class="details-specs">
                <div class="spec-row">
                    <span class="spec-label">Mouvement</span>
                    <span class="spec-value">@mouvement</span>
                </div>
                <div class="spec-row">
                    <span class="spec-label">Taille du boîtier</span>
                    <span class="spec-value">@tailleBoitier</span>
                </div>
                <div class="spec-row">
                    <span class="spec-label">Matériau</span>
                    <span class="spec-value">@materiau</span>
                </div>
                <div class="spec-row">
                    <span class="spec-label">Étanchéité</span>
                    <span class="spec-value">@etancheite</span>
                </div>
            </div>

            <button class="details-cta" type="button">
                Demander un devis
            </button>

            <a class="details-back" asp-controller="Produits" asp-action="Index">
                &laquo; Retour à la liste
            </a>
        </div>

    </div>

    <div class="details-bottom">
        <h3 class="bottom-title">Caractéristiques détaillées</h3>

        <div class="bottom-grid">
            <div class="bottom-col">
                <div><span class="k">Mouvement</span> @mouvement</div>
                <div><span class="k">Calibre</span> @calibre</div>
                <div><span class="k">Matériau</span> @materiau</div>
                <div><span class="k">Bracelet</span> @bracelet</div>
            </div>

            <div class="bottom-col">
                <div><span class="k">Taille</span> @tailleBoitier</div>
                <div><span class="k">Étanchéité</span> @etancheite</div>
                <div><span class="k">Verre</span> @verreDetail</div>
                <div><span class="k">Loupe Cyclope</span> @loupeCyclope</div>
            </div>
        </div>
    </div>

</div>
